import{_ as t,o as i,c as a,ag as e}from"./chunks/framework.rAhUSuuf.js";const r=JSON.parse('{"title":"点赞接口","description":"","frontmatter":{},"headers":[],"relativePath":"api/public/like.md","filePath":"api/public/like.md","lastUpdated":null}'),l={name:"api/public/like.md"};function n(d,s,p,h,o,k){return i(),a("div",null,[...s[0]||(s[0]=[e(`<h1 id="点赞接口" tabindex="-1">点赞接口 <a class="header-anchor" href="#点赞接口" aria-label="Permalink to &quot;点赞接口&quot;">​</a></h1><p>文章和评论点赞相关的公开接口。</p><h2 id="获取点赞状态" tabindex="-1">获取点赞状态 <a class="header-anchor" href="#获取点赞状态" aria-label="Permalink to &quot;获取点赞状态&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>GET /api/like</span></span></code></pre></div><p>获取当前页面的点赞状态和总点赞数，一般由前端组件在页面加载时自动调用。</p><ul><li>方法：<code>GET</code></li><li>路径：<code>/api/like</code></li><li>鉴权：不需要</li></ul><p><strong>查询参数</strong></p><table tabindex="0"><thead><tr><th>名称</th><th>位置</th><th>类型</th><th>必填</th><th>说明</th></tr></thead><tbody><tr><td><code>post_slug</code></td><td>query</td><td>string</td><td>是</td><td>页面唯一标识符，<code>window.location.origin + window.location.pathname</code></td></tr></tbody></table><p><strong>请求头（可选）</strong></p><table tabindex="0"><thead><tr><th>名称</th><th>必填</th><th>示例</th><th>说明</th></tr></thead><tbody><tr><td><code>X-CWD-Like-User</code></td><td>否</td><td><code>550e8400-e29b-41d4-a716...</code></td><td>前端生成的匿名用户标识，用于区分不同用户</td></tr></tbody></table><p>未显式传入 <code>X-CWD-Like-User</code> 时，服务端会尝试使用 <code>cf-connecting-ip</code> 作为用户标识，找不到时退回到 <code>anonymous</code>。</p><p><strong>成功响应</strong></p><ul><li>状态码：<code>200</code></li></ul><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;liked&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;alreadyLiked&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;totalLikes&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>字段说明：</p><table tabindex="0"><thead><tr><th>字段名</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td><code>liked</code></td><td>boolean</td><td>当前用户是否已点赞</td></tr><tr><td><code>alreadyLiked</code></td><td>boolean</td><td>预留字段，当前实现始终为 <code>false</code></td></tr><tr><td><code>totalLikes</code></td><td>number</td><td>当前页面的总点赞数</td></tr></tbody></table><p><strong>错误响应</strong></p><ul><li><p>缺少 <code>post_slug</code>：</p><ul><li>状态码：<code>400</code></li></ul><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;post_slug is required&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p>服务器内部错误：</p><ul><li>状态码：<code>500</code></li></ul><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;获取点赞状态失败&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ul><h2 id="点赞文章" tabindex="-1">点赞文章 <a class="header-anchor" href="#点赞文章" aria-label="Permalink to &quot;点赞文章&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>POST /api/like</span></span></code></pre></div><p>对当前页面执行点赞操作，同一用户对同一页面只会计入一次点赞。</p><ul><li>方法：<code>POST</code></li><li>路径：<code>/api/like</code></li><li>鉴权：不需要</li></ul><p><strong>请求头</strong></p><table tabindex="0"><thead><tr><th>名称</th><th>必填</th><th>示例</th><th>说明</th></tr></thead><tbody><tr><td><code>ContentC-Type</code></td><td>是</td><td><code>application/json</code></td><td></td></tr><tr><td><code>X-CWD-Like-User</code></td><td>否</td><td><code>550e8400-e29b-41d4-a716...</code></td><td>前端生成的匿名用户标识，用于区分不同用户</td></tr></tbody></table><p><strong>请求体</strong></p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;postSlug&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://example.com/blog/hello-world&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;postTitle&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;博客标题，可选&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;postUrl&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://example.com/blog/hello-world&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>字段说明：</p><table tabindex="0"><thead><tr><th>字段名</th><th>类型</th><th>必填</th><th>说明</th></tr></thead><tbody><tr><td><code>postSlug</code></td><td>string</td><td>是</td><td>页面唯一标识符，应与评论接口中的 <code>post_slug</code> 一致</td></tr><tr><td><code>postTitle</code></td><td>string</td><td>否</td><td>页面标题，用于点赞统计中显示</td></tr><tr><td><code>postUrl</code></td><td>string</td><td>否</td><td>页面 URL，用于点赞统计中跳转</td></tr></tbody></table><p><strong>成功响应</strong></p><ul><li>状态码：<code>200</code></li></ul><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;liked&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;alreadyLiked&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;totalLikes&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">13</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>说明：</p><ul><li>第一次点赞：<code>liked=true</code>，<code>alreadyLiked=false</code>，<code>totalLikes</code> 增加 1；</li><li>重复点赞：服务器不会重复插入记录，<code>alreadyLiked=true</code>，<code>totalLikes</code> 不会继续增加。</li></ul><p><strong>错误响应</strong></p><ul><li><p>缺少 <code>postSlug</code>：</p><ul><li>状态码：<code>400</code></li></ul><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;postSlug is required&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p>服务器内部错误：</p><ul><li>状态码：<code>500</code></li></ul><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;点赞失败&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ul>`,35)])])}const g=t(l,[["render",n]]);export{r as __pageData,g as default};
